{"version":3,"file":"falldown.js","sources":["../node_modules/clicked/clicked.js","../node_modules/eventemitter3/index.js","../code/falldown.js"],"sourcesContent":["/**\n * Watcher for click, double-click, or long-click event for both mouse and touch\n * @example\n * import { clicked } from 'clicked'\n *\n * function handleClick()\n * {\n *    console.log('I was clicked.')\n * }\n *\n * const div = document.getElementById('clickme')\n * const c = clicked(div, handleClick, { thresshold: 15 })\n *\n * // change callback\n * c.callback = () => console.log('different clicker')\n *\n * // destroy\n * c.destroy()\n *\n * // using built-in querySelector\n * clicked('#clickme', handleClick2)\n *\n * // watching for all types of clicks\n * function handleAllClicks(e) {\n *     switch (e.type)\n *     {\n *         case 'clicked': ...\n *         case 'double-clicked': ...\n *         case 'long-clicked': ...\n *     }\n *\n *     // view UIEvent that caused callback\n *     console.log(e.event)\n * }\n * clicked('#clickme', handleAllClicks, { doubleClicked: true, longClicked: true })\n */\n\n/** @type {object} */\nconst defaultOptions = {\n    thresshold: 10,\n    clicked: true,\n    doubleClicked: false,\n    doubleClickedTime: 300,\n    longClicked: false,\n    longClickedTime: 500,\n    capture: false,\n    clickDown: false\n}\n\n/**\n * @param {HTMLElement|string} element or querySelector entry (e.g., #id-name or .class-name)\n * @param {ClickedCallback} callback called after a click, double click, or long click is registered\n * @param {object} [options]\n * @param {number} [options.thresshold=10] if touch moves threshhold-pixels then the touch-click is cancelled\n * @param {boolean} [options.clicked=true] disable watcher for default clicked event\n * @param {boolean} [options.doubleClicked] enable watcher for double click\n * @param {number} [options.doubleClickedTime=500] wait time in millseconds for double click\n * @param {boolean} [options.longClicked] enable watcher for long click\n * @param {number} [options.longClickedTime=500] wait time for long click\n * @param {boolean} [options.clickDown] enable watcher for click start\n * @param {boolean} [options.capture]  events will be dispatched to this registered listener before being dispatched to any EventTarget beneath it in the DOM tree\n * @returns {Clicked}\n */\nexport function clicked(element, callback, options)\n{\n    return new Clicked(element, callback, options)\n}\n\nclass Clicked\n{\n    constructor(element, callback, options)\n    {\n        if (typeof element === 'string')\n        {\n            element = document.querySelector(element)\n            if (!element)\n            {\n                console.warn(`Unknown element: document.querySelector(${element}) in clicked()`)\n                return\n            }\n        }\n        this.options = Object.assign({}, defaultOptions, options)\n        this.events = {\n            mousedown: (e) => this.mousedown(e),\n            mouseup: (e) => this.mouseup(e),\n            mousemove: (e) => this.mousemove(e),\n            touchstart: (e) => this.touchstart(e),\n            touchmove: (e) => this.touchmove(e),\n            touchcancel: (e) => this.cancel(e),\n            touchend: (e) => this.touchend(e)\n        }\n        element.addEventListener('mousedown', this.events.mousedown, { capture: this.options.capture })\n        element.addEventListener('mouseup', this.events.mouseup, { capture: this.options.capture })\n        element.addEventListener('mousemove', this.events.mousemove, { capture: this.options.capture })\n        element.addEventListener('touchstart', this.events.touchstart, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchmove', this.events.touchmove, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchcancel', this.events.touchcancel, { capture: this.options.capture})\n        element.addEventListener('touchend', this.events.touchend, { capture: this.options.capture })\n        this.element = element\n        this.callback = callback\n    }\n\n    /**\n     * removes event listeners added by Clicked\n     */\n    destroy()\n    {\n        this.element.removeEventListener('mousedown', this.events.mousedown)\n        this.element.removeEventListener('mouseup', this.events.mouseup)\n        this.element.removeEventListener('mousemove', this.events.mousemove)\n        this.element.removeEventListener('touchstart', this.events.touchstart, { passive: true })\n        this.element.removeEventListener('touchmove', this.events.touchmove, { passive: true })\n        this.element.removeEventListener('touchcancel', this.events.touchcancel)\n        this.element.removeEventListener('touchend', this.events.touchend)\n    }\n\n    touchstart(e)\n    {\n        if (this.down === true)\n        {\n            this.cancel()\n        }\n        else\n        {\n            if (e.touches.length === 1)\n            {\n                this.handleDown(e.changedTouches[0].screenX, e.changedTouches[0].screenY)\n            }\n        }\n    }\n\n    pastThreshhold(x, y)\n    {\n        return Math.abs(this.lastX - x) > this.threshhold || Math.abs(this.lastY - y) > this.threshhold\n    }\n\n    touchmove(e)\n    {\n        if (this.down)\n        {\n            if (e.touches.length !== 1)\n            {\n                this.cancel()\n            }\n            else\n            {\n                const x = e.changedTouches[0].screenX\n                const y = e.changedTouches[0].screenY\n                if (this.pastThreshhold(x, y))\n                {\n                    this.cancel()\n                }\n            }\n        }\n    }\n\n    /** cancel current event */\n    cancel()\n    {\n        this.down = false\n        if (this.doubleClickedTimeout)\n        {\n            clearTimeout(this.doubleClickedTimeout)\n            this.doubleClickedTimeout = null\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n    }\n\n    touchend(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e, e.pointerId)\n        }\n    }\n\n    handleClicks(e)\n    {\n        if (this.options.doubleClicked)\n        {\n            this.doubleClickedTimeout = setTimeout(() => this.doubleClicked(e), this.options.doubleClickedTime)\n        }\n        else if (this.options.clicked)\n        {\n            this.callback({ event: e, type: 'clicked' })\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n        this.down = false\n    }\n\n    handleDown(e, x, y)\n    {\n        if (this.doubleClickedTimeout)\n        {\n            if (this.pastThreshhold(x, y))\n            {\n                if (this.options.clicked)\n                {\n                    this.callback({ event: e, type: 'clicked' })\n                }\n                this.cancel()\n            }\n            else\n            {\n                this.callback({ event: e, type: 'double-clicked' })\n                this.cancel()\n            }\n        }\n        else\n        {\n            this.lastX = x\n            this.lastY = y\n            this.down = true\n            if (this.options.longClicked)\n            {\n                this.longClickedTimeout = setTimeout(() => this.longClicked(e), this.options.longClickedTime)\n            }\n            if (this.options.clickDown) {\n                this.callback({ event: e, type: 'click-down' })\n            }\n        }\n    }\n\n    longClicked(e)\n    {\n        this.longClikedTimeout = null\n        this.down = false\n        this.callback({ event: e, type: 'long-clicked' })\n    }\n\n    doubleClicked(e)\n    {\n        this.doubleClickedTimeout = null\n        this.callback({ event: e, type: 'double-clicked' })\n    }\n\n    mousedown(e)\n    {\n        if (this.down === true)\n        {\n            this.down = false\n        }\n        else\n        {\n            this.handleDown(e, e.screenX, e.screenY)\n        }\n    }\n\n    mousemove(e)\n    {\n        if (this.down)\n        {\n            const x = e.screenX\n            const y = e.screenY\n            if (this.pastThreshhold(x, y))\n            {\n                this.cancel()\n            }\n        }\n    }\n\n    mouseup(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e)\n        }\n    }\n}\n\n/**\n * Callback for\n * @callback Clicked~ClickedCallback\n * @param {UIEvent} event\n * @param {('clicked'|'double-clicked'|'long-clicked'|'click-down')} type\n */","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { clicked } from 'clicked'\nimport Events from 'eventemitter3'\n\nimport STYLES from './styles.json'\n\nclass FallDown extends Events\n{\n    /**\n     * @param {object} options\n     * @param {(HTMLElement|string)} [options.element] use preexisting element for FallDown with optional data in attributes (provide either options.element or options.parent)\n     * @param {HTMLElement} [options.parent] use thsi parent to create the FallDown (provide either options.element or options.parent)\n     * @param {string[]|FallDownElement[]} [options.options] list of values for FallDown box\n     * @param {string} [options.separatorOptions=\",\"] separator used to split attribute data-options from options.element\n     * @param {(string|string[]|FallDownElement[]|FallDownElement)} [options.selected=''] default value (may also be in the form of \"item1,item2,item3\" where \",\"=options.separatorOptions)\n     * @param {string} [options.label] label for FallDown box\n     * @param {string} [options.size] set this to force the editbox to have a certain size regardless of content--this size does not include the arrow size, if any (e.g., '5rem')\n     * @param {string} [options.minSize=longest] longest=size to largest option; otherwise use this as minWidth (e.g., '5rem')\n     * @param {boolean} [options.allowEdit] can type entry\n     * @param {string} [options.multipleName] when set and more than 1 item is selected then text changes to \"n items\" where n is the number selected and items=multipleName\n     * @param {string} [options.multipleSeparator=\", \"] when showing multiple options on the selector, use this to separate the options\n     * @param {(object|boolean)} [options.arrow=true] change open and close arrows; set to false to remove\n     * @param {string} [options.arrow.up=&#9652;]\n     * @param {string} [options.arrow.down=&#9662;]\n     * @param {boolean} [options.addCSS] append styles directly to DOM instead of using stylesheet\n     * @param {boolean} [options.addCSSClassName=falldown] change class names of added CSS styles (useful if you want multiple falldown boxes on same page with different styles)\n     * @param {object} [options.styles] changes default styles if options.addCSS=true\n     * @param {object} [options.styles.main]\n     * @param {object} [options.styles.label]\n     * @param {object} [options.styles.selection]\n     * @param {object} [options.styles.selected]\n     * @param {object} [options.styles.arrow]\n     * @param {object} [options.styles.box]\n     * @param {object} [options.styles.select]\n     * @param {object} [options.styles.option]\n     * @param {object} [options.styles.cursor]\n     * @param {object} [options.styles.focus]\n     * @param {object} [options.classNames] change default class names of elements; don't use if options.addCSS=true\n     * @param {string} [options.classNames.main=falldown-main]\n     * @param {string} [options.classNames.label=falldown-label]\n     * @param {string} [options.classNames.selection=falldown-selection]\n     * @param {string} [options.classNames.selected=falldown-selected]\n     * @param {string} [options.classNames.arrow=falldown-arrow]\n     * @param {string} [options.classNames.box=falldown-box]\n     * @param {string} [options.classNames.select=falldown-select]\n     * @param {string} [options.classNames.option=falldown-option]\n     * @param {string} [options.classNames.cursor=falldown-cursor]\n     * @param {string} [options.classNames.focus=falldown-focus]\n     * @fires select\n     */\n    constructor(options = {})\n    {\n        super()\n        if (!FallDown.setup)\n        {\n            window.addEventListener('resize', FallDown.resize)\n            window.addEventListener('keydown', FallDown.keydown)\n            FallDown.setup = true\n        }\n        /**\n         * Main element\n         * @type HTMLElement\n         */\n        if (options.element)\n        {\n            if (typeof options.element === 'string')\n            {\n                this.element = document.querySelector(options.element)\n                if (!this.element)\n                {\n                    console.warn(`Falldown could not find document.querySelector(${options.element})`)\n                    return\n                }\n            }\n            else\n            {\n                this.element = options.element\n            }\n        }\n        else\n        {\n            this.element = document.createElement('div')\n        }\n        if (options.addCSS || this.element.getAttribute('data-add-css'))\n        {\n            this.addStyles(options)\n        }\n        this.options = options\n        this.setupOptions()\n        this.element.classList.add(options.classNames.main)\n        let s = `<div class=\"${options.classNames.label}\">${options.label}</div>` +\n            `<div class=\"${options.classNames.selection}\" tabindex=\"0\">` +\n            `<div class=\"${options.classNames.selected}\"></div>` +\n            (options.arrow ? `<div class=\"${options.classNames.arrow}\">${options.arrow.down}</div>` : '') +\n            `<div class=\"${options.classNames.box}\">`\n        this.optionsToFallDownOptions(options)\n        for (let option of this.falldown)\n        {\n            s += `<div class=\"${options.classNames.option}${option.selected ? ` ${options.classNames.select}` : ''}\">${option.html}</div>`\n        }\n        s += '</div></div>'\n        this.element.innerHTML = s\n        /**\n         * Whether dropdown box is showing\n         * @type boolean\n         */\n        this.showing = false\n        this.label = this.element.querySelector('.' + options.classNames.label)\n        this.selection = this.element.querySelector('.' + options.classNames.selection)\n        this.selection.setAttribute('tabindex', this.selection.getAttribute('tabindex') || 0)\n        this.selected = this.selection.querySelector('.' + options.classNames.selected)\n        this.arrow = this.element.querySelector('.' + options.classNames.arrow)\n        this.box = this.selection.querySelector('.' + options.classNames.box)\n        if (options.parent)\n        {\n            options.parent.appendChild(this.element)\n        }\n        const elements = this.box.querySelectorAll('.' + options.classNames.option)\n        for (let i = 0; i < elements.length; i++)\n        {\n            clicked(elements[i], () =>\n            {\n                this.cursorActive = false\n                this.emit('select', this.select(i))\n                if (this.options.multiple)\n                {\n                    this.clearCursor()\n                }\n                else\n                {\n                    this.close()\n                }\n            })\n        }\n        this.cursor = null\n        this.options = options\n        clicked(this.label, () => this.toggle(), { clicked: false, clickDown: true })\n        if (this.arrow)\n        {\n            clicked(this.arrow, () => this.toggle(), { clicked: false, clickDown: true })\n        }\n        clicked(this.selected, () => this.toggle(), { clicked: false, clickDown: true })\n        this.selection.addEventListener('focus', () =>\n        {\n            this.focused = true\n            this.selection.classList.add(this.options.classNames.focus)\n            FallDown.active = this\n        })\n        this.selection.addEventListener('blur', () => this.blur())\n        this.box.style.display = 'block'\n        if (this.options.size)\n        {\n            this.selected.style.width = this.options.size\n            this.selected.style.overflow = 'hidden'\n        }\n        else if (this.options.minSize === 'longest')\n        {\n            let longest = 0\n            for (let i = 0; i < this.box.childNodes.length; i++)\n            {\n                const width = this.box.childNodes[i].offsetWidth\n                longest = width > longest ? width : longest\n                this.selected.style.minWidth = longest + 'px'\n            }\n        }\n        else\n        {\n            this.selected.style.minWidth = this.options.minSize\n        }\n        if (!options.allowEdit)\n        {\n            this.selected.style.userSelect = 'none'\n        }\n        this.showSelection()\n        this.box.style.display = 'none'\n    }\n\n    blur()\n    {\n        if (this.showing)\n        {\n            this.focused = false\n            this.close()\n            this.selection.classList.remove(this.options.classNames.focus)\n            if (FallDown.active === this)\n            {\n                FallDown.active = null\n            }\n        }\n    }\n\n    /** toggle the falldown box open or closed */\n    toggle()\n    {\n        if (this.showing)\n        {\n            this.close()\n        }\n        else\n        {\n            this.open()\n        }\n    }\n\n    optionsToFallDownOptions(options)\n    {\n        /**\n         * list of items in falldown box\n         * @type {FallDownElement[]}\n         */\n        this.falldown = []\n        let selected = []\n        if (options.selected)\n        {\n            if (Array.isArray(options.selected))\n            {\n                if (typeof options.selected[0] === 'string' || !isNaN(options.selected[0]))\n                {\n                    selected = options.selected\n                }\n                else\n                {\n                    for (let item of options.selected)\n                    {\n                        selected.push(item.value)\n                    }\n                }\n            }\n            else if (typeof options.selected === 'string' || !isNaN(options.selected))\n            {\n                if (options.selected.indexOf(options.separatorOptions) !== -1)\n                {\n                    selected = options.selected.split(options.separatorOptions)\n                }\n                else\n                {\n                    selected.push(options.selected)\n                }\n            }\n            else\n            {\n                selected.push(options.selected.value)\n            }\n        }\n        for (let i = 0; i < options.options.length; i++)\n        {\n            const option = options.options[i]\n            if (typeof option === 'string' || !isNaN(option))\n            {\n                this.falldown.push({ value: option, html: option, selected: selected.indexOf(option) !== -1 })\n            }\n            else\n            {\n                this.falldown.push(option)\n                option.selected = option.selected || selected.indexOf(option.value) !== -1\n            }\n        }\n    }\n\n    /**\n     * returns current value (or array of values)\n     * @return (string|string[])\n     */\n    get value()\n    {\n        const list = []\n        for (let item of this.falldown)\n        {\n            if (item.selected)\n            {\n                list.push(item.value)\n            }\n        }\n        if (this.options.multiple)\n        {\n            return list\n        }\n        else\n        {\n            return list[0]\n        }\n    }\n\n    setupOptions()\n    {\n        const options = this.options\n        const element = this.element\n        options.selected = options.selected || element.getAttribute('data-selected') || ''\n        const dataOptions = element.getAttribute('data-options')\n        options.options = options.options || (dataOptions ? dataOptions.split(options.separatorOptions || ',') : [])\n        options.label = options.label || element.getAttribute('data-label') || ''\n        options.multiple = options.multiple || element.getAttribute('data-multiple')\n        options.multipleName = options.multipleName || element.getAttribute('data-multiple-name')\n        options.arrow = typeof options.arrow === 'undefined' ? { up: '&#9652', down: '&#9662;' } : options.arrows\n        options.minSize = options.minSize || element.getAttribute('data-minsize') || 'longest'\n        if (!options.classNames)\n        {\n            options.classNames = {}\n        }\n        options.classNames.main = options.classNames.main || 'falldown-main'\n        options.classNames.label = options.classNames.label || 'falldown-label'\n        options.classNames.selection = options.classNames.selection || 'falldown-selection'\n        options.classNames.box = options.classNames.box || 'falldown-box'\n        options.classNames.select = options.classNames.select || 'falldown-select'\n        options.classNames.selected = options.classNames.selected || 'falldown-selected'\n        options.classNames.arrow = options.classNames.arrow || 'falldown-arrow'\n        options.classNames.option = options.classNames.option || 'falldown-option'\n        options.classNames.cursor = options.classNames.cursor || 'falldown-cursor'\n        options.classNames.focus = options.classNames.focus || 'falldown-focus'\n        if (options.addCSSClassName)\n        {\n            for (let key in options.classNames)\n            {\n                options.classNames[key] = options.classNames[key].replace('falldown', options.addCSSClassName)\n            }\n        }\n    }\n\n    addStyles(options)\n    {\n        options.styles = options.styles || {}\n        let s = ''\n        for (let selector in STYLES)\n        {\n            const selectorName = options.addCSSClassName ? selector.replace('falldown', options.addCSSClassName) : selector\n            const simple = selector.replace('.falldown-', '')\n            s += selectorName + '{'\n            for (let label in STYLES[selector])\n            {\n                const replace = options.styles[simple]\n                if (!replace || !replace[label])\n                {\n                    s += label + ':' + STYLES[selector][label] + ';'\n                }\n            }\n            for (let label in options.styles[simple])\n            {\n                s += label + ':' + options.styles[simple][label] + ';'\n            }\n            s += '}'\n        }\n        const style = document.createElement('style')\n        style.innerText = s\n        document.head.appendChild(style)\n    }\n\n    /**\n     * open falldown box\n     */\n    open()\n    {\n        if (!this.showing)\n        {\n            this.box.style.display = 'block'\n            if (this.options.arrow)\n            {\n                this.arrow.innerHTML = this.options.arrow.up\n            }\n            this.resizeBox()\n            FallDown.active = this\n            this.cursor = null\n            this.showing = true\n            this.selection.focus()\n        }\n    }\n\n    resizeBox()\n    {\n        const width = window.innerWidth\n        const height = window.innerHeight\n        let box = this.box.getBoundingClientRect()\n        const selection = this.selected.getBoundingClientRect()\n        this.box.style.maxHeight = 'unset'\n        if (selection.top + selection.height / 2 > height / 2)\n        {\n            this.box.style.bottom = this.selection.offsetHeight + 'px'\n            this.box.style.top = 'unset'\n            const box = this.box.getBoundingClientRect()\n            if (box.top < 0)\n            {\n                const style = window.getComputedStyle(this.box)\n                const spacing = parseFloat(style.marginLeft) + parseFloat(style.marginRight) + parseFloat(style.paddingLeft) + parseFloat(style.paddingRight) + parseFloat(style.borderLeftWidth) + parseFloat(style.borderRightWidth)\n                this.box.style.maxHeight = box.height + box.top - spacing + 'px'\n            }\n        }\n        else\n        {\n            this.box.style.top = this.selection.offsetHeight + 'px'\n            this.box.style.bottom = 'unset'\n            const box = this.box.getBoundingClientRect()\n            if (box.bottom > height)\n            {\n                const style = window.getComputedStyle(this.box)\n                const spacing = parseFloat(style.marginTop) + parseFloat(style.marginBottom) + parseFloat(style.paddingTop) + parseFloat(style.paddingBottom) + parseFloat(style.borderTopWidth) + parseFloat(style.borderBottomWidth)\n                this.box.style.maxHeight = height - box.top - spacing + 'px'\n            }\n        }\n        this.box.style.width = 'fit-content'\n        if (selection.left >= width / 2)\n        {\n            this.box.style.right = 0\n            this.box.style.left = 'unset'\n            box = this.box.getBoundingClientRect()\n            if (box.left < 0)\n            {\n                this.box.style.right = box.left + 'px'\n                this.box.style.left = 'unset'\n            }\n        }\n        else\n        {\n            this.box.style.left = 0\n            this.box.style.right = 'unset'\n            box = this.box.getBoundingClientRect()\n            if (box.right >= width)\n            {\n                this.box.style.left = width - box.right + 'px'\n                this.box.style.right = 'unset'\n            }\n        }\n        const lastCheck = this.box.getBoundingClientRect()\n        if (lastCheck.left < 0 || lastCheck.right > window.innerWidth)\n        {\n            const check = this.element.getBoundingClientRect()\n            this.box.style.width = 'calc(100vw - 2rem - 4px)'\n            this.box.style.left = -check.left + 'px'\n            this.box.style.right = 'auto'\n        }\n    }\n\n    /**\n     * close falldown box\n     */\n    close()\n    {\n        if (this.showing)\n        {\n            this.clearCursor()\n            this.box.style.display = 'none'\n            this.selection.classList.remove(this.options.classNames.focus)\n            if (this.options.arrow)\n            {\n                this.arrow.innerHTML = this.options.arrow.down\n            }\n            this.showing = false\n        }\n    }\n\n    setCursor(i)\n    {\n        if (this.cursorActive)\n        {\n            this.clearCursor()\n            if (i === this.box.childNodes.length)\n            {\n                i = 0\n            }\n            else if (i === -1)\n            {\n                i = this.box.childNodes.length - 1\n            }\n            this.cursor = i\n            this.box.childNodes[this.cursor].classList.add(this.options.classNames.cursor)\n            this.scrollIntoBoxView(this.box.childNodes[this.cursor])\n        }\n    }\n\n    // TODO: does not work properly when scrolling up :(\n    scrollIntoBoxView(element)\n    {\n        const bounding = element.getBoundingClientRect()\n        if (bounding.top < 0)\n        {\n            this.box.scrollTop -= bounding.top\n        }\n        else if (bounding.bottom > window.innerHeight)\n        {\n            this.box.scrollTop -= window.innerHeight - bounding.bottom\n        }\n    }\n\n    clearCursor()\n    {\n        if (this.cursor !== null)\n        {\n            this.box.childNodes[this.cursor].classList.remove(this.options.classNames.cursor)\n        }\n    }\n\n    /**\n     * force selection of options based on value (clearing the remaining options)\n     * @param {*} input or array of values to select\n     */\n    force(input)\n    {\n        if (this.options.multiple)\n        {\n            for (let i = 0; i < this.falldown.length; i++)\n            {\n                if (input.indexOf(i) !== -1)\n                {\n                    this.box.childNodes[i].classList.add(this.options.classNames.select)\n                    this.falldown[i].selected = true\n                }\n                else\n                {\n                    this.box.childNodes[i].classList.remove(this.options.classNames.select)\n                    this.falldown[i].selected = false\n                }\n            }\n            this.showSelection()\n        }\n        else\n        {\n            for (let i = 0; i < this.falldown.length; i++)\n            {\n                if (this.falldown[i].value === input)\n                {\n                    this.box.childNodes[i].classList.add(this.options.classNames.select)\n                    this.falldown[i].selected = true\n                    this.selection.innerHTML = input\n                }\n                else\n                {\n                    this.box.childNodes[i].classList.remove(this.options.classNames.select)\n                    this.falldown[i].selected = false\n                }\n            }\n            this.showSelection()\n        }\n    }\n\n    /**\n     * remove selected option\n     * @param {number} index\n     */\n    remove(index)\n    {\n        this.box.childNodes[index].classList.remove(this.options.classNames.select)\n        this.falldown[index].selected = false\n        return this.showSelection()\n    }\n\n    showSelection()\n    {\n        const list = []\n        for (let i = 0; i < this.falldown.length; i++)\n        {\n            if (this.falldown[i].selected)\n            {\n                list.push(this.falldown[i].html)\n            }\n        }\n        if (list.length > 1)\n        {\n            if (this.options.multipleName)\n            {\n                this.selected.innerHTML = list.length + this.options.multipleName\n            }\n            else\n            {\n                let s = ''\n                for (let i = 0; i < list.length - 1; i++)\n                {\n                    s += list[i] + (this.options.multipleSeparator || ', ')\n                }\n                this.selected.innerHTML = s + list[list.length - 1]\n            }\n        }\n        else if (list.length === 1)\n        {\n            this.selected.innerHTML = list[0]\n        }\n        else\n        {\n            this.selected.innerHTML = ''\n        }\n        return list\n    }\n\n    /**\n     * clear all selections\n     */\n    clear()\n    {\n        for (let i = 0; i < this.falldown.length; i++)\n        {\n            this.box.childNodes[i].classList.remove(this.options.classNames.select)\n            this.falldown[i].selected = false\n        }\n        this.showSelection()\n    }\n\n    /**\n     * select option by HTML\n     * @param {string} name\n     */\n    selectByHTML(html)\n    {\n        for (let i = 0; i < this.falldown.length; i++)\n        {\n            if (this.falldown.html === html)\n            {\n                return this.select(i)\n            }\n        }\n    }\n\n    /**\n     * select option by index\n     * @param {number} index\n     */\n    select(index)\n    {\n        if (this.cursor)\n        {\n            this.clearCursor()\n        }\n        if (this.options.multiple)\n        {\n            const changed = this.falldown[index]\n            changed.selected = !changed.selected\n            this.box.childNodes[index].classList.toggle(this.options.classNames.select)\n            this.showSelection()\n            this.setCursor(index)\n            return { changed, value: this.value, falldown: this }\n        }\n        else\n        {\n            for (let i = 0; i < this.falldown.length; i++)\n            {\n                if (i === index)\n                {\n                    this.box.childNodes[i].classList.add(this.options.classNames.select)\n                    this.falldown[i].selected = true\n                }\n                else\n                {\n                    this.box.childNodes[i].classList.remove(this.options.classNames.select)\n                    this.falldown[i].selected = false\n                }\n            }\n            this.showSelection()\n            return { changed: this.falldown[index], value: this.value, falldown: this }\n        }\n    }\n\n    /**\n     * get index (or list of indices) for selected value(s)\n     * @return (number|number[])\n     */\n    getIndex()\n    {\n        const list = []\n        for (let i = 0; i < this.falldown.length; i++)\n        {\n            if (this.falldown[i].selected)\n            {\n                list.push(i)\n            }\n        }\n        if (this.options.multiple)\n        {\n            return list\n        }\n        else\n        {\n            return list.length ? list[0] : null\n        }\n    }\n\n    selectDelta(delta, unset)\n    {\n        if (this.options.multiple)\n        {\n            this.setCursor(this.cursor === null ? 0 : this.cursor + delta)\n        }\n        else\n        {\n            let index = this.getIndex()\n            if (index === null)\n            {\n                index = unset\n            }\n            else\n            {\n                index += delta\n                index = index < 0 ? this.falldown.length + index : index\n                index = index >= this.falldown.length ? index - this.falldown.length : index\n            }\n            this.box.childNodes[index].scrollIntoView()\n            this.emit('select', this.select(index))\n        }\n    }\n\n    static cancel()\n    {\n        const active = FallDown.active\n        if (active && active.showing)\n        {\n            active.close()\n        }\n    }\n\n    static keydown(e)\n    {\n        const active = FallDown.active\n        if (active)\n        {\n            switch (e.key)\n            {\n                case 'ArrowDown':\n                    active.cursorActive = true\n                    if (!active.showing)\n                    {\n                        active.open()\n                    }\n                    else\n                    {\n                        active.selectDelta(1, 0)\n                    }\n                    e.preventDefault()\n                    break\n\n                case 'ArrowUp':\n                    active.cursorActive = true\n                    if (!active.showing)\n                    {\n                        active.open()\n                    }\n                    else\n                    {\n                        active.selectDelta(-1, active.box.childNodes.length - 1)\n                    }\n                    e.preventDefault()\n                    break\n\n                case 'Space':\n                case 'Enter':\n                case ' ':\n                    active.cursorActive = true\n                    if (!active.showing)\n                    {\n                        active.open()\n                    }\n                    else\n                    {\n                        if (active.options.multiple)\n                        {\n                            active.emit('select', active.select(active.cursor))\n                            if (!active.options.multiple)\n                            {\n                                active.close()\n                            }\n                        }\n                        else\n                        {\n                            active.close()\n                        }\n                    }\n                    e.preventDefault()\n                    break\n\n                case 'Escape':\n                    active.cursorActive = false\n                    active.close()\n                    e.preventDefault()\n                    break\n            }\n        }\n    }\n\n    /**\n     * load falldown on all elements with the proper className\n     * @param {string} className=falldown type convert\n     */\n    static load(className = 'falldown')\n    {\n        const divs = document.querySelectorAll('.' + className)\n        for (let i = 0; i < divs.length; i++)\n        {\n            new FallDown({ element: divs[i] })\n        }\n    }\n\n    static resize()\n    {\n        const active = FallDown.active\n        if (active && active.showing)\n        {\n            active.resizeBox()\n        }\n    }\n}\n\n/**\n * @typedef {Object} FallDown#FallDownElement\n * @property {*} value\n * @property {string} html to display\n */\n\n/**\n * fires when the selection of the falldown changes\n * @event FallDown#select\n * @type {object}\n * @property {FallDownElement} changed\n * @property {*} value - array of values (for option.multiple) or value of selected item\n * @property {FallDown} falldown - FallDown element\n */\n\n export { FallDown }"],"names":["defaultOptions","thresshold","clicked","doubleClicked","doubleClickedTime","longClicked","longClickedTime","capture","clickDown","element","callback","options","Clicked","[object Object]","document","querySelector","this","Object","assign","events","mousedown","e","mouseup","mousemove","touchstart","touchmove","touchcancel","cancel","touchend","addEventListener","passive","console","warn","removeEventListener","down","touches","length","handleDown","changedTouches","screenX","screenY","x","y","Math","abs","lastX","threshhold","lastY","pastThreshhold","doubleClickedTimeout","clearTimeout","longClickedTimeout","preventDefault","handleClicks","pointerId","setTimeout","event","type","longClikedTimeout","has","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","addListener","emitter","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","FallDown","super","setup","window","resize","keydown","createElement","addCSS","getAttribute","addStyles","setupOptions","classList","add","classNames","main","s","label","selection","selected","arrow","box","optionsToFallDownOptions","option","falldown","select","html","innerHTML","showing","setAttribute","parent","appendChild","elements","querySelectorAll","cursorActive","multiple","clearCursor","close","cursor","toggle","focused","focus","active","blur","style","display","size","width","overflow","minSize","longest","childNodes","offsetWidth","minWidth","allowEdit","userSelect","showSelection","remove","open","isArray","isNaN","item","value","indexOf","separatorOptions","split","list","dataOptions","multipleName","up","arrows","addCSSClassName","key","replace","styles","selector","STYLES","selectorName","simple","innerText","head","resizeBox","innerWidth","height","innerHeight","getBoundingClientRect","maxHeight","top","bottom","offsetHeight","getComputedStyle","spacing","parseFloat","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","marginTop","marginBottom","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","left","right","lastCheck","check","scrollIntoBoxView","bounding","scrollTop","input","index","multipleSeparator","changed","setCursor","delta","unset","getIndex","scrollIntoView","selectDelta","className","divs"],"mappings":"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"}